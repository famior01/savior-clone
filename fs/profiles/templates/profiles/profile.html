
{% extends 'base.html' %} 
{% load static %}
{% block title %}{{profile.user.username}}{% endblock title %}

{% block content %}
<link rel="stylesheet" type="text/css" href={% static 'profiles/style.css' %}>

<div style="margin-top: 20px" class="ui container-xl ">
  <div class="ui segment">
    <div class="ui grid">
    <!--Proflie introduction!-->
      <div class="row">
        <i><h1 style="text-align: center">{{profile.slogan}}</h1></i>
      </div>

      <div class="row">
        <div class="ui grid">
          <div class="nine wide column">
            <div class="ui items">
              <div class="item">
                <div class="css-after">
                  <img class='' src="{{profile.avatar.url}}">
                </div>
                <div class="content">
                  <h2>{{profile.user.username}}</h2>
                  <h4>{{profile.user.full_name}}</h4>
                  <p style='width:12em'>{{profile.bio}}</p>
                  
                  {% if request.user != profile.user %}
                    {% if profile in my_profile.get_followers%}
                      <div class="ui compact menu">
                        <form action="{% url 'profiles:follow-unfollow-profile' %}" method=post>
                          {% csrf_token %}
                            <input type="hidden" name="profile_pk" value={{profile.pk}}>
                            <button class='ui mini secondary button' type='submit'>Follow Back</button>
                        </form>
                        <br>
                          <a href=" {% url 'profiles:remove-follower'  profile.pk %} ">
                            <button class='ui mini secondary button' type='submit'>Remove from my follower</button>
                          </a>
                      </div>
                    {% elif my_profile in profile.get_followers %}
                      <div class="ui left floated">
                        <form action="{% url 'profiles:follow-unfollow-profile' %}" method=post>
                          {% csrf_token %}
                          <input type="hidden" name="profile_pk" value={{profile.pk}}>
                          <button class='ui large secondary button' type='submit'>UnFollow</button>
                        </form>
                      </div>
                    {% else %}
                      <div class="ui left floated">
                        <form action="{% url 'profiles:follow-unfollow-profile' %}" method=post>
                          {% csrf_token %}
                          <input type="hidden" name="profile_pk" value={{profile.pk}}>
                          <button class='ui large secondary button' type='submit'>Follow</button>
                        </form>
                      </div>
                    {% endif %}

                  {% else %}
                      <a href="{% url  'profiles:profile-update' user.pk %}">
                        <button class="ui large secondary button">Edit Profile</button>
                      </a>                
                  {% endif %}

                  <br><br>
                  <div class="description">
                    <div class="ui blue labels">
                      {% if user == profile.user %}
                        {% if myfollowers > 1 %}
                          <a href=" {% url 'profiles:followers' profile.pk %} ">
                            <div class="ui label">{{myfollowers}}&#160;&#160;
                              Followers
                            </div>
                          </a>
                        {% else %}
                          <a href=" {% url 'profiles:followers' profile.pk %} ">
                            <div class="ui label">{{profile.get_follower_no}}&#160;&#160;
                              Follower
                            </div>
                          </a>
                        {% endif %}
                      {% else %}
                        <a href=" {% url 'profiles:followers' profile.pk %} ">
                          <div class="ui label">{{profile.get_follower_no}}&#160;&#160;
                            Followers
                          </div>
                        </a>
                      {% endif %}
                      
                      {% if user == profile.user %}
                      <a href="{% url 'profiles:following' profile.pk %}">
                        <div class="ui label" data-tooltip="Only you can see your following" data-position="bottom left"><b>{{profile.get_following_no}}</b>&nbsp; Following
                        </div>
                      </a>
                      {% endif %}
                    
                      <div class="ui label"><b>{{profile.get_post_no}} &nbsp; IWatch Posts</b></div>
                      <div class="ui label"><b>{{profile.get_zakat_posts_no}}</b> &nbsp;Zakat Posts</div>
                    </div>
                  </div>
                </div>
              </div>    
            </div>
          </div>
          <div class="seven wide column">
            <h3>Introduction</h3>{{profile.intro}}
            <br><br>
            <span><strong>Address</strong></span>: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; {{profile.cur_add}} <br>
            <span><strong>Profession</strong></span>:&nbsp;&nbsp;&nbsp;{{profile.profession}} <br>
            <span><strong>Religion</strong></span>:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{{user.religion}} <br>
            <span><strong>Phone #</strong></span>: &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;{{profile.phone_number}} <br>

          </div>
        </div>
      </div>
      
    </div>    
  </div>
</div>


<div style="margin-top: 20px" class="ui container-xl">
  <div class="ui grid">
    <div class="ui row">
      <div style='width:50em; margin-left:17%' class="ui menu">
        <button style='margin-left:33%;' class="ui black basic button">
          <a href="{% url 'profiles:zakat_posts' profile.pk %}">
            Zakat Posts
          </a>
        </button>
        <br>
        <button style='margin-right:33%;' class="ui black basic button">
        <a href="{% url 'profiles:iwatch' profile.pk %}">
          IWatch
        </a>
        </button>
      </div>
    </div>
  </div>
</div>
  
  <!--in prof_zakat_posts, I applied conditon that fetch all those post where user is creator-->
  <!--by default this will be shown-->

<div style="margin-top: 20px" class="ui container-xl ">

  {% block posts %}
    {% if IWatch %}
      {% include "profiles/profile_IWatch.html" %}
    {% else %} <!--else ZakatPosts-->
      {% include "profiles/profile_zakat_posts.html" %}
    {% endif %}
  {% endblock posts %} 

</div>



<script src= "{% static 'profiles/main.js' %}" defer></script>
{% endblock content %}
