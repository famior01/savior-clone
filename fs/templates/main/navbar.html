{% url 'posts:main-post-view' as path_to_posts%}
{% url 'profiles:myprofile' as path_to_myprofile %}


{% url 'profiles:all-profiles' as path_to_all_profiles %}
{% url 'profiles:my-invites' as path_to_my_invites %}
{% url 'profiles:sent-invites' as user_friend_request %}
{% url 'zakat_posts:main-post-view' as zakat_posts_home %}
{% url 'zakat_posts:satisfied' as satisfied %}


{% load static %}
{% load notifications_tags %}

{% comment %} <link rel="stylesheet" type="text/css" href={% static 'css/style.css' %}> {% endcomment %}


<div class="ui inverted menu nav">
    <div class="ui container fluid  ">
    {% if request.user.is_authenticated %}
        <a href="{{zakat_posts_home}}" class="{% if request.path == path_to_posts %}active{% endif %} item">
            <h1>Family Savior</h1>
        </a>
    {% else %}
        <!--for sign up-->
        <a href="#" class="item"><h1>Family Savior</h1></a>
    {% endif %}
    &nbsp;&nbsp;

    <!--I watch icon-->
    {% if request.user.is_authenticated %}
        <a href="{{path_to_posts}}" class="{% if request.path == path_to_posts %}active{% endif %} item">
            <i class="youtube icon"></i>IWatch
        </a>
    {% endif %}
    &nbsp;&nbsp;

    <!--Zakat icon-->
    {% if request.user.is_authenticated %}
        <a href="{{zakat_posts_home}}" class="{% if request.path == zakat_posts_home %}active{% endif %} item">
            <i class=" user md icon"></i>
            Zakat
        </a>
    {% endif %}
    &nbsp;&nbsp;

    <!--Satisfied icon-->
    {% if request.user.is_authenticated %}
        <a href="{{satisfied}}" class="{% if request.path == satisfied %}active{% endif %} item">
            <i class="check icon"></i>Satisfied
        </a>
    {% endif %}
    &nbsp;&nbsp;

    <!--Peoples-->
    {% if request.user.is_authenticated %}

        <!--Search icon-->
        <div class="item">
            <form action="" method="GET">
                <div class="ui action left icon input">
                <input class="prompt" type="text" name='q' placeholder="name of a friend...">
                <i class="search icon"></i>
                <button type='submit' class="ui button">Search</button>
                </div>
            </form>
        </div>

        <!--Friends icon-->
        <div class="item right floated">
            <div class="ui floating dropdown icon button teal"> Friends
                <i class="dropdown icon"></i>
                <div class="menu">
                    <a href="{{path_to_all_profiles}}" class="{% if request.path == path_to_all_profiles %}active{% endif %} item">
                        All Profiles
                    </a>
                    <a href="{{user_friend_request}}" class="{% if request.path == user_friend_request %}active{% endif %} item">
                        Send Invites
                    </a>
                    <!--with notification bannar-->
                    <a href="{{path_to_my_invites}}" class="{% if request.path == path_to_my_invites %}active{% endif %} item">
                        Received Invites &nbsp <div class='ui purple horizontal label'>{{invitations_no}}</div>
                    </a>
                </div>
            </div>
        </div>
        

        <!-- Notification icon in semantic ui-->
        {% comment %} {% register_notify_callbacks callbacks='fill_notification_list,fill_notification_badge' %}  {% endcomment %}

        <!-- People -->
        <div class="item">
            <a href="{{path_to_all_profiles}}">
            <i class="users icon large"></i>
            </a>
        </div>
        <div class="item" >
            <div class="ui inline dropdown scrolling">
                
                <i class="bell icon large" ></i>
                {% live_notify_badge %}
                <div class="menu">
                    <!--Delete ALL Notificaitons-->
                    <div class="ui segment red raised">
                    <a href="{% url 'DeleteAllNotifications'  %}" id='delete_all'>
                        <button type='submit' name='DeleteAllNotifications' 
                        class="ui button bwhite-lg ">Delete All</button></a>

                    <!--Read All notifications-->
                    <a href="{% url 'ReadAllNotifications'  %}">
                        <button type='submit' name='ReadAllNotifications' 
                        class="ui button bwhite-lg ">Read All</button></a>
                    <div class="ui divider" style="margin: 5px 0;"></div>

                    {% for qs in user.notifications.unread %}
                    <div class="ui list segment raised red" id='noti_box'>  
                            <div class="item mb">
                            {% for profile in profiles  %}
                                {% if qs.actor == profile.user %}
                                    <div class="ui header"> 
                                    <img class='ui circular image' src="{{profile.avatar.url}}">
                                    {{ qs.actor.full_name}}
                                    </div>
                                    <div class="description">
                                        {{ qs.verb }}   
                                    </div>
                                    <div>
                                    {% if 'following' in qs.verb %}
                                        {% if profile.user not in my_profile.following.all %}
                                            <form action="{% url 'profiles:follow-unfollow-profile' %}" method='POST'>
                                                {% csrf_token %}
                                                <input type="hidden" name="profile_pk" value={{profile.pk}}>
                                                <button class='ui mini basic blue button' type='submit'>
                                                    Follow Back
                                                </button>
                                            </form>
                                        {% else  %}
                                            <form action="{% url 'profiles:follow-unfollow-profile' %}" method='POST'>
                                                {% csrf_token %}
                                                <input type="hidden" name="profile_pk" value={{profile.pk}}>
                                                <button class='ui mini basic green button' type='submit'>
                                                    Following
                                                </button>
                                            </form>
                                        {% endif %}
                                    {% endif %}
                                    </div>
                                    <br>
                                    <div class="description">
                                        {{ qs.timestamp|timesince }}
                                        
                                    </div>
                                {% endif %}
                            {% endfor %}

                            <div>
                                {% if request.user.is_authenticated %}
                                {% comment %}<form action="{% url 'notifications_read' %}" id='{{qs.pk}}' class='read_one' >
                                        {% csrf_token %}
                                        <button type='submit' id='{{qs.pk}}' name='read'
                                        class="ui button bwhite-lg ">Read</button>
                                    </form> {% endcomment %}
                                    
                                    <a href="{% url 'notifications_delete' qs.pk %}">
                                        <button type='submit' name='delete' 
                                        class="ui button bwhite-lg ">Delete</button>
                                    </a>
                                    {% endif %}
                                    </div>
                                <div class="ui divider" style="margin: 5px 0;"></div>
                            </div>
                        </div>
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>



        <!--Profile icon-->
        <div class='item'>
            <a href="{{path_to_myprofile}}" class="{% if request.path == path_to_myprofile %}active{% endif %} item">
                <img src="{{profile_picture}}" class='ui avatar image'>&nbsp;{{request.user.username}}
            </a>
        </div>

        <!--nice dropdown menu for semantic ui-->
        <div class="item">
        <div class="ui floating dropdown icon button teal">
            <i class="align justify icon"></i>
            <div class="menu">
                <a href="{% url 'account_logout' %}" class="item">
                    <i class="sign out alternate icon"></i>Logout
                </a>
                <!--account change password-->
                <a href="{% url 'account_change_password' %}" class="item">
                    <i class="key icon"></i>Change Password
                </a>
            </div>
        </div>
        </div>

        

        {% else %}
            <!--for sign up-->
            <div class='item'>
                <a href="{% url 'account_login' %}" class="ui item">Login</a>
            </div>
            <div class='item'>
                <a href="{% url 'account_signup' %}" class="ui item">Signup</a>
            </div>
        {% endif %}
        
</div>
</div>
</div>

<!--Notification-->
<script src="{% static 'notifications/notify.js' %}" type="text/javascript"></script>
{% comment %} <script src="{% static 'js/base.js' %}" defer></script>
already coming from base.html
{% endcomment %}